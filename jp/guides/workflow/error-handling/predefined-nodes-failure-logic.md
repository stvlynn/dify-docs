# 事前定義されたエラー処理ロジック

以下の4つのノードは、エラー状況に対応するためのロジックを構築する機能を提供しています：

* [LLM](../node/llm.md)
* [HTTP](../node/http-request.md)
* [コード](../node/code.md)
* [ツール](../node/tools.md)

エラー処理のためには、次の3つの事前に定義されたロジックオプションがあります：

* **処理なし**：エラーを処理せずに、ノードからのエラーメッセージをそのまま返し、フロー全体を停止します。
* **デフォルト値**：開発者がエラー情報をあらかじめ定義できるようにします。エラーが発生した場合、定義された値によって元のノードが返すエラー情報を置き換えます。
* **エラーブランチ**：エラーが発生した場合、あらかじめ設定されたエラー処理のブランチを実行します。

<figure><img src="https://assets-docs.dify.ai/2024/12/6e2655949889d4d162945d840d698649.png" alt=""><figcaption><p>エラー処理</p></figcaption></figure>

### 処理ロジック：処理なし

これはノードのエラー処理のデフォルト設定であり、タイムアウトやエラーが発生した場合には直接エラーメッセージをスローし、全体の処理フローを中断します。この場合、ワークフローアプリケーションは実行失敗として記録されます。

### 処理ロジック：デフォルト値

開発者はデフォルト値エディタを使用して、ノードのエラー出力情報をカスタマイズできます。これは、プログラミングにおけるステップバイステップ（逐次的な）デバッグに似ており、アプリケーションのデバッグプロセスをより明確にします。

例えば：
* `object`や`array`型には、直観的な`JSON`エディタを用意しています。
* `number`や`string`型には、それぞれの型に合わせたエディタを用意しています。

ノードの実行が失敗した場合、フローは自動的に開発者が設定したデフォルト値を使用し、オリジナルのエラー出力情報の代わりとして処理を続行します。これにより、より明確なエラーメッセージが得られ、開発者はアプリケーションのフローデザインの最適化に注力できます。

> デフォルト値のデータ構造は、ノードの出力変数と一致します。例えば、コードノードの出力変数をarray[number]データタイプに設定した場合、デフォルト値のデータタイプも同様にarray[number]になります。

<figure><img src="https://assets-docs.dify.ai/2024/12/e9e5e757090679243e0c9976093c7e6c.png" alt=""><figcaption><p>エラー処理：デフォルト値</p></figcaption></figure>

### 処理ロジック：エラーブランチ

現在のノードの実行でエラーが発生した場合、予め設定されたエラーブランチがトリガーされます。この選択を行うと、新たな接続点が現在のノードに追加され、開発者はキャンバス上で次の処理フローを構築するか、ノード詳細の右下隅で下流ノードを追加することができます。

> エラーブランチはオレンジ色の線で示されます。

<figure><img src="https://assets-docs.dify.ai/2024/12/e5ea1af947818bd9e27cab3042c1c4f3.png" alt=""><figcaption></figcaption></figure>

一般的な戦略としては、エラーブランチ内でエラーに対応するノードを配置し、修正されたデータを変数集約ノードを介して元のフローにリンクし、結果を集約して出力します。例えば、メールツールノードを接続してエラー情報を送信することができます。

**エラー変数**

ノードのエラー処理を「デフォルト値」または「エラーブランチ」に設定した場合、エラー状況が発生すると、`error_type`および`error_message`といった変数を通じて下流ノードにエラー情報が伝えられます。

<table>
  <thead>
    <tr>
      <th>変数名</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>error_type</code></td>
      <td>エラーのタイプ。ノードの種類によって異なるエラータイプがあり、開発者はそれぞれのエラーに対して適切な対処法を選択できます。</td>
    </tr>
    <tr>
      <td><code>error_message</code></td>
      <td>具体的なエラーメッセージ。これはエラー発生元のノードが出力する詳細な障害情報であり、開発者はこれを利用してエラーを修正したり、メールツールを通じて情報を送信したりできます。</td>
    </tr>
  </tbody>
</table>